library(ggplot2)
p <- ggplot() +
geom_line(aes(x = years, y = y1, color = "Scenario X")) +
geom_line(aes(x = years, y = y2, color = "Scenario Y")) +
scale_color_manual(values = c("Scenario X" = "red", "Scenario Y" = "blue")) +
xlab("Year") +
ylab("Yield (ton)") +
labs(title = NULL, color = NULL) +
theme(plot.background = element_rect(fill = "black", color = NA),
panel.background = element_rect(fill = "black", color = NA),
plot.title = element_text(hjust = 0.5, color = "white"),
axis.text = element_text(color = "white"),
axis.title = element_text(color = "white"),
legend.position = "top",
legend.direction = "horizontal",
legend.box = "horizontal",
legend.box.just = "left",
legend.margin = margin(t = -10, l = 0, b = 0, r = 0),
legend.background = element_rect(fill = "black", color = NA),
legend.text = element_text(color = "white"))
# Remove the gray background boxes from the legend symbols
p + guides(color = guide_legend(override.aes = list(fill = "white", alpha = 0.5)))
# Save the plot as a PNG file with a black background
ggsave("line_chart.png", plot = p, dpi = 300, width = 6, height = 4, units = "in")
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("dodged_stacked_bar_chart.png", plot = p, dpi = 300, width = 6, height = 4, units = "in")
# Bar chart
library(ggplot2)
library(dplyr)
library(tidyr)
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 2),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 4),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45, 20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65, 40, 50, 60, 70, 45, 55, 65, 75,
50, 60, 70, 80, 55, 65, 75, 85, 60, 70, 80, 90, 65, 75, 85, 95,
70, 80, 90, 100, 75, 85, 95, 105))
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") ++
scale_fill_brewer(palette = "Pastel") +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors, alpha = 0.3) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))
# Define colors for each category
colors <- c("#FEC5BB80", "#EAFFD080", "#E2FDBD80", "#C7E9FF80")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors, alpha=0.8) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))
# Define colors for each category
colors <- c("#FEC5BB80", "#EAFFD080", "#E2FDBD80", "#C7E9FF80")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge", alpha = 0.8) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("dodged_stacked_bar_chart.png", plot = p, dpi = 300, width = 6, height = 4, units = "in")
# Define pastel colors and alpha
colors <- c("#D9D9D9", "#C7B6A7", "#D7E5ED", "#A5B1C2")
alpha_val <- 0.8
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors, alpha = alpha_val) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))->p
# Define pastel colors and alpha
colors <- c("#D9D9D9", "#C7B6A7", "#D7E5ED", "#A5B1C2")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge", alpha=0.8) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))->p
# Remove the gray background boxes from the legend symbols
p + guides(color = guide_legend(override.aes = list(fill = "white", alpha = 0.5)))
# Save the plot as a PNG file with a black background
ggsave("dodged_stacked_bar_chart.png", plot = p, dpi = 300, width = 6, height = 4, units = "in")
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))->p
# Save the plot as a PNG file with a black background
ggsave("dodged_stacked_bar_chart.png", plot = p, dpi = 300, width = 6, height = 4, units = "in")
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#1f78b4", "#33a02c", "#e31a1c", "#ff7f00")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "dodge") +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Runoff (mm)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_blank(),
strip.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("dodged_stacked_bar_chart.png", plot = p, dpi = 300, width = 6, height = 4, units = "in")
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.8) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Runoff (mm)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("stacked_bar_chart.png", dpi = 300, width = 6, height = 4, units = "in", bg = "black")
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.8) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Runoff (mm)", y = NULL) +
theme_dark() +
theme(legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("stacked_bar_chart.png", dpi = 300, width = 6, height = 4, units = "in", bg = "black")
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("Scenario X", "Scenario Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.8) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(plot.background = element_rect(fill = "black", color = NA),
panel.background = element_rect(fill = "black", color = NA),
legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"))
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("Scenario X", "Scenario Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.5) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(plot.background = element_rect(fill = "black", color = NA),
panel.background = element_rect(fill = "black", color = NA),
legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("stacked_bar_chart.png", dpi = 300, width = 6, height = 4, units = "in", bg = "black")
# Bar chart
library(ggplot2)
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada"), each = 8),
Scenario = rep(rep(c("Scenario X", "Scenario Y"), each = 4), 4),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 8),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.5) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(plot.background = element_rect(fill = "black", color = NA),
panel.background = element_rect(fill = "black", color = NA),
legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"),
legend.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("stacked_bar_chart.png", dpi = 300, width = 6, height = 4, units = "in", bg = "black")
# Bar chart
library(ggplot2)
# Create sample data
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada", "Mexico", "Brazil", "Australia", "Russia", "Japan", "France"), each = 8),
Scenario = rep(rep(c("X", "Y"), each = 4), 10),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 20),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75,
25, 35, 45, 55, 30, 40, 50, 60,
35, 45, 55, 65, 40, 50, 60, 70,
30, 40, 50, 60, 35, 45, 55, 65,
45, 55, 65, 75, 50, 60, 70, 80,
35, 45, 55, 65, 40, 50, 60, 70,
50, 60, 70, 80, 55, 65, 75, 85,
40, 50, 60, 70, 45, 55, 65, 75,
60, 70, 80, 90, 65, 75, 85, 95,
45, 55, 65, 75, 50, 60, 70, 80,
70, 80, 90, 100, 75, 85, 95, 105,
50, 60, 70, 80, 55, 65, 75, 85,
75, 85, 95, 105, 80, 90, 100, 110,
55, 65, 75, 85, 60, 70, 80, 90,
80, 90, 100, 110, 85, 95, 105, 115,
60, 70, 80, 90, 65, 75, 85, 95,
90, 100, 110, 120, 95, 105, 115, 125))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.5) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(plot.background = element_rect(fill = "black", color = NA),
panel.background = element_rect(fill = "black", color = NA),
legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"),
legend.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("stacked_bar_chart.png", dpi = 300, width = 6, height = 4, units = "in", bg = "black")
# Bar chart
library(ggplot2)
# Create sample data
# Create sample data
df <- data.frame(Country = rep(c("USA", "China", "India", "Canada", "Mexico", "Brazil", "Australia", "Russia", "Japan", "France"), each = 8),
Scenario = rep(rep(c("Scenario X", "Scenario Y"), each = 4), 10),
Category = rep(c("Category 1", "Category 2", "Category 3", "Category 4"), 20),
Runoff = c(10, 20, 30, 40, 15, 25, 35, 45,
20, 30, 40, 50, 25, 35, 45, 55,
30, 40, 50, 60, 35, 45, 55, 65,
40, 50, 60, 70, 45, 55, 65, 75,
25, 35, 45, 55, 30, 40, 50, 60,
35, 45, 55, 65, 40, 50, 60, 70,
30, 40, 50, 60, 35, 45, 55, 65,
45, 55, 65, 75, 50, 60, 70, 80,
35, 45, 55, 65, 40, 50, 60, 70,
50, 60, 70, 80, 55, 65, 75, 85,
40, 50, 60, 70, 45, 55, 65, 75,
60, 70, 80, 90, 65, 75, 85, 95,
45, 55, 65, 75, 50, 60, 70, 80,
70, 80, 90, 100, 75, 85, 95, 105,
50, 60, 70, 80, 55, 65, 75, 85,
75, 85, 95, 105, 80, 90, 100, 110,
55, 65, 75, 85, 60, 70, 80, 90,
80, 90, 100, 110, 85, 95, 105, 115,
60, 70, 80, 90, 65, 75, 85, 95,
90, 100, 110, 120, 95, 105, 115, 125))
# Define colors for each category
colors <- c("#a6cee3", "#b2df8a", "#fb9a99", "#fdbf6f")
# Create the plot
ggplot(df, aes(x = Runoff, y = Country, fill = Category)) +
geom_bar(stat = "identity", position = "stack", alpha = 0.5) +
facet_wrap(~ Scenario, ncol = 2, scales = "free_y") +
scale_fill_manual(values = colors) +
labs(x = "Yield (ton)", y = NULL) +
theme_dark() +
theme(plot.background = element_rect(fill = "black", color = NA),
panel.background = element_rect(fill = "black", color = NA),
legend.position = "top",
legend.title = element_blank(),
legend.background = element_rect(fill = "transparent"),
legend.key = element_blank(),
axis.line.y = element_blank(),
axis.text.y = element_text(color = "white"),
axis.ticks.y = element_blank(),
strip.background = element_rect(fill = "black"),
strip.text = element_text(color = "white"),
legend.text = element_text(color = "white"))
# Save the plot as a PNG file with a black background
ggsave("stacked_bar_chart.png", dpi = 300, width = 6, height = 4, units = "in", bg = "black")
